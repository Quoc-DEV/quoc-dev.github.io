<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

<meta name="theme-color" content="#2c3e50">
<head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    <!-- Enable responsiveness on mobile devices-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <title>

        Write awesome unit tests &middot; Jeroen Mols

    </title>

    <!-- CSS -->
    <link rel="stylesheet" href="/public/css/poole.css">
    <link rel="stylesheet" href="/public/css/syntax.css">
    <link rel="stylesheet" href="/public/css/hyde.css">
    <link rel="stylesheet"
          href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

    <!-- Fonts -->
    <link rel="stylesheet" href="/css/font-awesome/css/font-awesome.min.css">
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"
          type="text/css">

    <!-- Icons -->
    <link rel="favicon-144-precomposed" sizes="144x144"
          href="http://jeroenmols.com/favicon-144-precomposed.png">
    <link rel="shortcut icon" href="http://jeroenmols.com/favicon.ico">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63356566-1', 'auto');
  ga('send', 'pageview');



</script>

<body class="theme-base-custom">
<div class="sidebar">
    <div class="container sidebar-sticky">
        <div class="sidebar-about sidebar-title">

            <img class="img-responsive" src="/img/profile_round.png" alt="">

            <h1>
                <a class="sidebar-link" href="/blog">
                    Jeroen Mols
                </a>
            </h1>

            <ul class="list-inline">

                <li>
                    <a href="https://twitter.com/molsjeroen" class="btn-social btn-outline"
                       target="blank"><i class="fa fa-fw fa-twitter"></i></a>
                </li>

                <li>
                    <a href="https://stackoverflow.com/users/2771851/jmols"
                       class="btn-social btn-outline" target="blank"><i
                            class="fa fa-fw fa-stack-overflow"></i></a>
                </li>

                <li>
                    <a href="https://github.com/JeroenMols" class="btn-social btn-outline"
                       target="blank"><i class="fa fa-fw fa-github"></i></a>
                </li>

                <li>
                    <a href="https://be.linkedin.com/pub/jeroen-mols/25/a62/995"
                       class="btn-social btn-outline" target="blank"><i
                            class="fa fa-fw fa-linkedin"></i></a>
                </li>

                <li>
                    <a href="https://speakerdeck.com/jeroenmols" class="btn-social btn-outline"
                       target="blank"><i class="fa fa-fw fa-file-pdf-o"></i></a>
                </li>

                <li>
                    <a href="https://feeds.feedburner.com/JeroenMols" class="btn-social btn-outline"
                       target="blank"><i class="fa fa-fw fa-rss"></i></a>
                </li>

            </ul>

            <p class="sidebar-subtitle">Android developer with a great <a class="sidebar-link"
                                                                          href="/">portfolio</a>.
            </p>
        </div>

        <div class="copyright">
            <p>Copyright &copy; Jeroen Mols 2017</p>
        </div>
    </div>
</div>

<div class="content container">
    <div class="post">
        <h1 class="post-title">Write awesome unit tests</h1>
        <span class="post-date">16 Feb 2017</span>


        <img src="/img/blog/unittests/unittests.png" alt="Write awesome unit tests"
             title="Alberto G., https://creativecommons.org/licenses/by/2.0/, cropped">


        <p>If you can code, you can also write unit tests. Writing awesome tests on the other hand
            is a different story. Don&#39;t fool yourself: Unit testing code is production code that
            you will need to maintain, refactor and build upon for years to come.</p>

        <p>This blogpost aims at providing three very simple rules that will significantly ramp up
            your testing game. Every rule is followed by pragmatic tips so you can easily start
            implementing.</p>

        <p><br></p>

        <h2>1. Run ludicrously fast</h2>

        <p>The only reason you write unit tests is to run them. This has two benefits:</p>

        <ol>
            <li>confirm that something is working properly</li>
            <li>detect when something stopped working</li>
        </ol>

        <p>In summary, tests are your safety net, the main weapon against regression. They make sure
            bugs remain fixed and allow you to refactor your code.</p>

        <p>There is one caveat however: for tests to do their job, you need to run them!</p>

        <p>Every time they run, they give you feedback about the code. And the shorter you can get
            your feedback loop, the sooner you&#39;ll notice bugs and the easier (=cheaper) it will
            be to fix. That means you don&#39;t just want to run them before every release, nor on a
            daily basis, but literally after every change you make.</p>

        <blockquote>
            <p>The more you run your test, the more value you&#39;ll get from them.</p>
        </blockquote>

        <p>Now the less time you have to wait for your tests to run, the more often you&#39;re going
            to run them. Consequently for you to run your tests often, they need to run fast...
            ludicrously fast.</p>

        <p>Not in one minute, not even in 10 seconds, but your entire test suite should pass in less
            than a second!</p>

        <p>This means you&#39;ll have to:</p>

        <ul>
            <li>run your tests on a JVM instead of on a device</li>
            <li>only test isolated pieces of business logic</li>
            <li>don&#39;t include UI, database or network tests in your main test suite</li>
            <li>don&#39;t use wait/sleep statements in tests</li>
        </ul>

        <p><br></p>

        <h2>2. Small and focussed tests</h2>

        <p>Always write your tests with failures in mind. This means explicitly designing your tests
            to catch bugs in your apps.</p>

        <p>Given a bug, would you prefer:</p>

        <ul>
            <li>one bug -&gt; multiple tests fail</li>
            <li>one bug -&gt; exactly one test fails</li>
        </ul>

        <p>Bingo, the second one, because that simplifies debugging. In case of a failing test you
            just look at the test name to see what went wrong.</p>
        <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">logInShouldFailWithWrongPassword</span><span
                    class="o">()</span> <span class="kd">throws</span> <span
                    class="n">Exception</span> <span class="o">{</span>
  <span class="c1">// Test code</span>
<span class="o">}</span>
</code></pre>
        </div>
        <blockquote>
            <p>For every bug, exactly one test must fail. The root cause of failure should be
                described by the test name.</p>
        </blockquote>

        <p>This forces you to only check for one thing per test and will lead to smaller tests that
            are easier to understand, easier to explain and easier to maintain.</p>

        <p>That&#39;s why a good test should be small (=few lines of code) and focussed (=only test
            for one thing), just like any other method in our codebase.</p>

        <p>This means you&#39;ll have to:</p>

        <ul>
            <li>write tests with only one single assert/verify statement</li>
            <li>have more small tests instead of fewer big ones</li>
            <li>clearly describe the cause of failure in test names</li>
        </ul>

        <p><br></p>

        <h2>3. 100% reliable</h2>

        <p>Tests are your safety net, so whenever that tells you something is wrong... you&#39;ll
            have to take it seriously. That means dropping everything to go and fix that failing
            test.</p>

        <p>Obviously that&#39;s quite frustrating as you&#39;re eager to build a feature and
            suddenly you have to start fire fighting somewhere else.</p>

        <p>Now imagine analyzing the problem for a couple of hours, not finding anything wrong,
            rerunning the tests (out of desperation) and every test suddenly passes...</p>

        <blockquote>
            <p>The most frustrating thing for a developer is waisting time on random errors that are
                fixed by a clean or IDE restart</p>
        </blockquote>

        <p>And if more tests behave the same way... you&#39;ll loose trust in your entire test
            suite. You stop taking failures seriously and stop having the benefits from your test
            suit altogether.</p>

        <p>That&#39;s why all your test need to be 100% reliable and only fail when there is
            actually a problem.</p>

        <p>This means you&#39;ll have to:</p>

        <ul>
            <li>run your tests on a JVM (connection to device can break)</li>
            <li>mock network communication during tests</li>
            <li>move UI/integration tests out of your unit test suite</li>
        </ul>

        <p><br></p>

        <h2>Wrap-up</h2>

        <p>The more you run your unit tests, the more value you&#39;ll get from them. Awesome unit
            tests facilitate exactly that by being fast, focussed and super reliable.</p>

        <p>As always you can reach me <a href="https://twitter.com/molsjeroen">@molsjeroen</a> on
            twitter, or leave a comment below!</p>


        <div class="social-follow">
            <a href="https://twitter.com/intent/user?screen_name=molsjeroen" rel="nofollow"
               class="twitter">
                <i class="fa fa-twitter"></i><span id="social-span"> Follow @molsjeroen</span>
            </a>
        </div>

    </div>

    <div class="social-share">
        <h2>Share on</h2>
        <ul>
            <li>
                <a href="https://twitter.com/intent/tweet?text=Write awesome unit tests&url=http://jeroenmols.com/blog/2017/02/16/unittests/&via=molsjeroen&related=molsjeroen&hashtags=androiddev"
                   onclick="window.open(
              'https://twitter.com/intent/tweet?text=Write awesome unit tests&url=http://jeroenmols.com/blog/2017/02/16/unittests/&via=molsjeroen&related=molsjeroen&hashtags=androiddev'
          ,'popup','width=600,height=600'); return false;" class="twitter" title="Share on Twitter"
                   rel="nofollow" target="popup">
                    <i class="fa fa-twitter"></i><span id="social-span"> Twitter</span>
                </a>
            </li>
            <li>
                <a href="https://www.facebook.com/sharer/sharer.php?u=http://jeroenmols.com/blog/2017/02/16/unittests/"
                   onclick="window.open(
              'https://www.facebook.com/sharer/sharer.php?u=http://jeroenmols.com/blog/2017/02/16/unittests/'
          ,'popup','width=600,height=600'); return false;" class="facebook"
                   title="Share on Facebook" rel="nofollow" target="popup">
                    <i class="fa fa-facebook"></i><span id="social-span"> Facebook</span></a>
                </a>
            </li>
            <li>
                <a href="https://plus.google.com/share?url=http://jeroenmols.com/blog/2017/02/16/unittests/"
                   onclick="window.open(
              'https://plus.google.com/share?url=http://jeroenmols.com/blog/2017/02/16/unittests/'
          ,'popup','width=600,height=600'); return false;" class="google-plus"
                   title="Share on Google Plus" rel="nofollow" target="popup">
                    <i class="fa fa-google-plus"></i><span id="social-span"> Google+</span></a>
                </a>
            </li>
            <!-- <li>
              <a href="http://www.linkedin.com/shareArticle?mini=true&url=http://jeroenmols.com/blog/2017/02/16/unittests/&title=Write awesome unit tests&summary=&source=http://jeroenmols.com"
                onclick="window.open(
                      'http://www.linkedin.com/shareArticle?mini=true&url=http://jeroenmols.com/blog/2017/02/16/unittests/&title=Write awesome unit tests&summary=&source=http://jeroenmols.com'
                  ,'popup','width=600,height=600'); return false;" class="linkedin" title="Share on Google Plus" rel="nofollow" target="popup">
                  <i class="fa fa-linkedin"></i><span id="social-span"> Linkedin</span></a>
              </a>
            </li> -->
        </ul>
        </br></br>
    </div><!-- /.social-share -->


    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- bottom-blog-responsive -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-9854541518226004"
         data-ad-slot="4086741379"
         data-ad-format="auto"></ins>
    <script>
(adsbygoogle = window.adsbygoogle || []).push({});


    </script>


    <h2>Comments</h2>
    <section class="post-comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES * * */
      var disqus_shortname = 'jeroenmols';

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();


        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript"
                                                          rel="nofollow">comments powered by
            Disqus.</a></noscript>
    </section>


    <div class="related">
        <h2>Related Posts</h2>
        <ul class="related-posts">


            <li>
                <h3>
                    <a href="/blog/2017/03/08/appcrash/">
                        Why your app should crash
                        <small>08 Mar 2017</small>
                    </a>
                </h3>
            </li>


            <li>
                <h3>
                    <a href="/blog/2017/01/17/mockitoandroid/">
                        Using Mockito 2.x on Android
                        <small>17 Jan 2017</small>
                    </a>
                </h3>
            </li>


        </ul>
    </div>

</div>
</body>
</html>
